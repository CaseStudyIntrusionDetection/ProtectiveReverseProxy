import numpy as np

# From https://github.com/Narengowda/http_headers/blob/master/headers.py
# and https://www.iana.org/assignments/message-headers/message-headers.xhtml

HTTP_HEADERS_LIST = [
    'Accept',
    'Accept-Additions',
    'Accept-Charset',
    'Accept-Datetime',
    'Accept-Encoding',
    'Accept-Features',
    'Accept-Language',
    'Accept-Patch',
    'Accept-Post',
    'Accept-Ranges',
    'Age',
    'Allow',
    'Also-Control',
    'Alt-Svc',
    'Alt-Used',
    'Alternate-Recipient',
    'Alternates',
    'Apply-To-Redirect-Ref',
    'Approved',
    'Archive',
    'Archived-At',
    'Article-Names',
    'Article-Updates',
    'Authentication-Control',
    'Authentication-Info',
    'Authentication-Results',
    'Authorization',
    'Auto-Submitted',
    'Autoforwarded',
    'Autosubmitted',
    'Base',
    'Bcc',
    'Body',
    'C-Ext',
    'C-Man',
    'C-Opt',
    'C-PEP',
    'C-PEP-Info',
    'Cache-Control',
    'CalDAV-Timezones',
    'Cc',
    'Close',
    'Comments',
    'Connection',
    'Content-Alternative',
    'Content-Base',
    'Content-Description',
    'Content-Disposition',
    'Content-Duration',
    'Content-Encoding',
    'Content-ID',
    'Content-Identifier',
    'Content-Language',
    'Content-Length',
    'Content-Location',
    'Content-MD5',
    'Content-Range',
    'Content-Return',
    'Content-Script-Type',
    'Content-Style-Type',
    'Content-Transfer-Encoding',
    'Content-Type',
    'Content-Version',
    'Content-features',
    'Control',
    'Conversion',
    'Conversion-With-Loss',
    'Cookie',
    'Cookie2',
    'DASL',
    'DAV',
    'DKIM-Signature',
    'DL-Expansion-History',
    'Date',
    'Date-Received',
    'Default-Style',
    'Deferred-Delivery',
    'Delivery-Date',
    'Delta-Base',
    'Depth',
    'Derived-From',
    'Destination',
    'Differential-ID',
    'Digest',
    'Discarded-X400-IPMS-Extensions',
    'Discarded-X400-MTS-Extensions',
    'Disclose-Recipients',
    'Disposition-Notification-Options',
    'Disposition-Notification-To',
    'Distribution',
    'Downgraded-Bcc',
    'Downgraded-Cc',
    'Downgraded-Disposition-Notification-To',
    'Downgraded-Final-Recipient',
    'Downgraded-From',
    'Downgraded-In-Reply-To',
    'Downgraded-Mail-From',
    'Downgraded-Message-Id',
    'Downgraded-Original-Recipient',
    'Downgraded-Rcpt-To',
    'Downgraded-References',
    'Downgraded-Reply-To',
    'Downgraded-Resent-Bcc',
    'Downgraded-Resent-Cc',
    'Downgraded-Resent-From',
    'Downgraded-Resent-Reply-To',
    'Downgraded-Resent-Sender',
    'Downgraded-Resent-To',
    'Downgraded-Return-Path',
    'Downgraded-Sender',
    'Downgraded-To',
    'ETag',
    'Encoding',
    'Encrypted',
    'Expect',
    'Expires',
    'Expiry-Date',
    'Ext',
    'Followup-To',
    'Forwarded',
    'From',
    'Generate-Delivery-Report',
    'GetProfile',
    'HTTP2-Settings',
    'Hobareg',
    'Host',
    'IM',
    'If',
    'If-Match',
    'If-Modified-Since',
    'If-None-Match',
    'If-Range',
    'If-Schedule-Tag-Match',
    'If-Unmodified-Since',
    'Importance',
    'In-Reply-To',
    'Incomplete-Copy',
    'Injection-Date',
    'Injection-Info',
    'Keep-Alive',
    'Keywords',
    'Label',
    'Language',
    'Last-Modified',
    'Latest-Delivery-Time',
    'Lines',
    'Link',
    'List-Archive',
    'List-Help',
    'List-ID',
    'List-Owner',
    'List-Post',
    'List-Subscribe',
    'List-Unsubscribe',
    'List-Unsubscribe-Post',
    'Location',
    'Lock-Token',
    'MIME-Version',
    'MMHS-Acp127-Message-Identifier',
    'MMHS-Codress-Message-Indicator',
    'MMHS-Copy-Precedence',
    'MMHS-Exempted-Address',
    'MMHS-Extended-Authorisation-Info',
    'MMHS-Handling-Instructions',
    'MMHS-Message-Instructions',
    'MMHS-Message-Type',
    'MMHS-Originator-PLAD',
    'MMHS-Originator-Reference',
    'MMHS-Other-Recipients-Indicator-CC',
    'MMHS-Other-Recipients-Indicator-To',
    'MMHS-Primary-Precedence',
    'MMHS-Subject-Indicator-Codes',
    'MT-Priority',
    'Man',
    'Max-Forwards',
    'Memento-Datetime',
    'Message-Context',
    'Message-ID',
    'Message-Type',
    'Meter',
    'NNTP-Posting-Date',
    'NNTP-Posting-Host',
    'Negotiate',
    'Newsgroups',
    'Obsoletes',
    'Opt',
    'Optional-WWW-Authenticate',
    'Ordering-Type',
    'Organization',
    'Origin',
    'Original-Encoded-Information-Types',
    'Original-From',
    'Original-Message-ID',
    'Original-Recipient',
    'Original-Sender',
    'Original-Subject',
    'Originator-Return-Address',
    'Overwrite',
    'P3P',
    'PEP',
    'PICS-Label',
    'Path',
    'Pep-Info',
    'Position',
    'Posting-Version',
    'Pragma',
    'Prefer',
    'Preference-Applied',
    'Prevent-NonDelivery-Report',
    'Priority',
    'ProfileObject',
    'Protocol',
    'Protocol-Info',
    'Protocol-Query',
    'Protocol-Request',
    'Proxy-Authenticate',
    'Proxy-Authentication-Info',
    'Proxy-Authorization',
    'Proxy-Features',
    'Proxy-Instruction',
    'Public',
    'Public-Key-Pins',
    'Public-Key-Pins-Report-Only',
    'Range',
    'Received',
    'Received-SPF',
    'Redirect-Ref',
    'References',
    'Referer',
    'Relay-Version',
    'Reply-By',
    'Reply-To',
    'Require-Recipient-Valid-Since',
    'Resent-Bcc',
    'Resent-Cc',
    'Resent-Date',
    'Resent-From',
    'Resent-Message-ID',
    'Resent-Reply-To',
    'Resent-Sender',
    'Resent-To',
    'Retry-After',
    'Return-Path',
    'SLUG',
    'Safe',
    'Schedule-Reply',
    'Schedule-Tag',
    'Sec-WebSocket-Accept',
    'Sec-WebSocket-Extensions',
    'Sec-WebSocket-Key',
    'Sec-WebSocket-Protocol',
    'Sec-WebSocket-Version',
    'Security-Scheme',
    'See-Also',
    'Sender',
    'Sensitivity',
    'Server',
    'Set-Cookie',
    'Set-Cookie2',
    'SetProfile',
    'SoapAction',
    'Solicitation',
    'Status-URI',
    'Strict-Transport-Security',
    'Subject',
    'Summary',
    'Supersedes',
    'Surrogate-Capability',
    'Surrogate-Control',
    'TCN',
    'TE',
    'TTL',
    'Timeout',
    'To',
    'Topic',
    'Trailer',
    'Transfer-Encoding',
    'URI',
    'Upgrade',
    'Urgency',
    'User-Agent',
    'VBR-Info',
    'Variant-Vary',
    'Vary',
    'Via',
    'WWW-Authenticate',
    'Want-Digest',
    'Warning',
    'X-Content-Type-Options',
    'X-Frame-Options',
    'X400-Content-Identifier',
    'X400-Content-Return',
    'X400-Content-Type',
    'X400-MTS-Identifier',
    'X400-Originator',
    'X400-Received',
    'X400-Recipients',
    'X400-Trace',
    'Xref'
]

# Only these headers actually occur in our dataset.
HTTP_RELEVANT_HEADERS = ['Accept', 'Accept-Encoding', 'Accept-Language', 'Cache-Control',
       'Connection', 'Content-Length', 'Content-Type', 'Cookie', 'Host',
       'Origin', 'Referer', 'User-Agent']

def transform_header_dict(header_dict, headers=HTTP_HEADERS_LIST):
    out = {}
    for header in headers:
        out[header] = 1.0 if header in header_dict else 0.0
    return out
